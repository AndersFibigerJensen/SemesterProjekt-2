@page
@model SemesterProjekt_2.Pages.Shifts.ShiftMemberModel
@{
    ViewData["Title"] = "Assign Member to Shift";
}

@{
    if(Model.CLIMember.IsAdmin)
    {
    <h1>You are currently editing ShiftID @Model.ShiftID</h1>
    <h2>Select a member to be assigned to the Shift. </h2>
    <h2>Only one member can be assigned to a shift at a time.</h2>

    <a asp-page="GetAllShifts">Back</a>

    <form method="get">
                    Search <input type="text" asp-for="FilterCriteria" />
                    <input type="submit" value="Filter" />
    </form>

    <table class="table">
                    <thead>
                        <tr>
                            <th>
                                Member ID
                            </th>
                            <th>
                                Name
                            </th>
                            <th>
                                Address
                            </th>
                            <th>
                                E-mail
                            </th>
                        </tr>
                    </thead>
                    <tbody>
                        @foreach (var item in Model.Members)
                        {
                            <tr>
                                <td>
                                    @item.MemberID
                                </td>
                                <td>
                                    @item.Name
                                </td>
                                <td>
                                    @item.Address
                                </td>
                                <td>
                                    @item.Email
                                </td>
                                @if (@item.HasDoneHygieneCourse)
                                {
                                   <td>
                                     <form method="post">
                                         <input type="submit" asp-route-memberid="@item.MemberID" asp-route-shiftid="@Model.ShiftID" value="Assign Member" class="btn btn-primary" />
                                     </form>
                                   </td>
                                }
                                else
                                {
                                    <td>
                                    Not done hygiene course
                                    </td>
                                }
                            </tr>
                        }
                    </tbody>
    </table>

    <form method="post">
                    <input type="submit" asp-route-memberid="-1" asp-route-shiftid="@Model.ShiftID" value="Clear Shift" class="btn btn-primary" />
    </form>
    }
    else if (Model.currentMID == Model.CLIMember.MemberID)
    {
    <h1>You are already assigned to shift no. @Model.ShiftID</h1>
    <h2>You cannot unassign yourself from the shift through the website.</h2>
    <h2>Please contact an admin if you wish to be unassigned. (phone number here)</h2>

    <a asp-page="GetAllShifts">Back</a>
    }
    else if (Model.CLIMember.HasDoneHygieneCourse)
    {
    <h1>Would you like to assign yourself to shift number @Model.ShiftID?</h1>
    <h2>Warning: You cannot unassign yourself from a shift through the website.</h2>

    <form method="post">
                    <input type="submit" asp-route-memberid="@Model.CLIMember.MemberID" asp-route-shiftid="@Model.ShiftID" value="Yes" class="btn btn-primary" />
    </form>

    <a asp-page="GetAllShifts">No</a>
    }
    else
    {
        <h1>You cannot assign yourself to shift no. @Model.ShiftID</h1>
        <h2>You have not done the mandatory hygiene course.</h2>
        <h2>Please contact an admin if this is a mistake. (phone number here)</h2>
    }
}

